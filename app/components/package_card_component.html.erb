<article
  class="w-full h-full border-solid border border-indigo-200 bg-indigo-50 p-2 flex flex-col"
  itemscope
  itemtype="http://schema.org/Article"
  itemprop="itemListElement"
>
  <h2 class="py-1">
    <% (@package.authors || []).each do |author| %>
      <span class="pr-2">
        <%= render AuthorLinkComponent.new(author: author) %>
      </span>
    <% end %>
    <%= time_tag @package.published_at.to_date, class: 'inline-block', itemprop: 'datePublished' %>
  </h2>

  <h1 class="text-xl font-bold" itemprop="name headline">
    <%= link_to @package.name, @package, itemprop: 'url' %>
  </h1>

  <ul class="pt-2" itemprop="keywords">
    <% tags_cats = (@package.tags || []).map { |t| render TagLinkComponent.new(tag: t) } \
         + (@package.categories || []).sort_by(&:last).reverse.map { |c| render CategoryLinkComponent.new(category: c) } %>
    <% tags_cats.each_with_index do |x, i| %>
      <li class="inline">
        <%= x %>
        <% if i < tags_cats.size - 1 %><span class="hidden">, </span><% end %>
      </li>
    <% end %>
  </ul>

  <p class="pt-4 text-gray-700">
    <% if @package.post_text.present? %>
      <%= simple_format(@package.post_text.truncate(150, separator: /\s/), itemprop: 'description') %>
    <% else %>
      <%= simple_format(helpers.package_description(@package, true), itemprop: 'description') %>
    <% end %>
  </p>

  <% if @package.question_distribution.present? %>
    <p class="pt-4">
      <%= t('total_questions') %>: <%= @package.question_distribution[:total] %>
    </p>
    <% @package.question_distribution[:types].each do |type, count| %>
      <span class="mr-4 inline-block">
        <div class="<%= ApplicationHelper::TYPE_COLORS[type] %> w-4 h-4 inline-block bottom-0"></div>
        <span class="font-bold">
          <%= t type %>
        </span>
        <span class="text-gray-700">
          <%=
          number_to_percentage(
          count.to_f / @package.question_distribution[:total] * 100,
          precision: 0
          )
          %>
        </span>
      </span>
    <% end %>
  <% end %>
</article>
